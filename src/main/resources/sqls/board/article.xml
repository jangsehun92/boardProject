<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="articleMapper">	

	<resultMap id="ArticleResultMap" type="Article">
		<result property="id" column="id"/>
		<result property="memberId" column="mb_id"/>
		<result property="category" column="category"/>
		<result property="writer" column="writer"/>
		<result property="title" column="title"/>
		<result property="content" column="content"/>
		<result property="regDate" column="reg_date" />
	</resultMap>
	
	<select id = "detail" parameterType="int" resultMap="ArticleResultMap">
		select 
			ID, 
			BOARD_TB.MB_ID,
			CATEGORY,
			MEMBER_TB.MB_NICKNAME AS WRITER, 
			TITLE, 
			CONTENT, 
			REG_DATE 
		from 
			BOARD_TB 
			join MEMBER_TB 
				on BOARD_TB.MB_ID = MEMBER_TB.MB_ID 
		where
			ID = #{id}
	</select>
	
	<insert id="save" parameterType="ArticleCreateRequest">	
		<selectKey keyProperty="id" resultType="int" order="BEFORE">
			select 
				BOARD_TB_SEQ.NEXTVAL 
			from 
				DUAL
		</selectKey>
		insert into 
			BOARD_TB 
		values(
			#{id},
			#{memberId}, 
			#{category}, 
			#{title},
			#{content},
			SYSDATE
		)
	</insert>
	
	<update id="update" parameterType="ArticleUpdateRequest">
		update 
			BOARD_TB
		SET
			TITLE = #{title},
			CONTENT = #{content}
		WHERE
			ID = #{id} and mb_id = #{memberId}
	</update>
	
	<delete id="delete" parameterType="int">
		delete
		from
			BOARD_TB
		where
			id = #{id}
	</delete>
	
</mapper>